---
title: C#의 JIT 컴파일이란?
date: 2023-08-11 16:55:47 +0900
categories: [프로그래밍, C++]
tags: [c, jit, il, 컴파일, clr, 인터프리터, 동적 변환]
---

C#이나 JAVA와 같은 언어들은 JIT(Just-In-Time) 컴파일을 사용합니다.

.NET 프레임워크에서의 C#은 전통적인 컴파일 언어와 인터프리터 언어 사이의 중간 지점에 위치해 있습니다.

이러한 방식을 <span class="keyword">**JIT(Just-In-Time)**</span> 컴파일 언어라고 분류합니다. JIT 컴파일의 개념을 사용하는 다른 언어에는 대표적으로 JAVA가 있습니다.

- **컴파일 방식**: 프로그램을 실행하기 전에 딱 한 번 기계어로 변환해 실행하는 방식
- **인터프리터 방식**: 프로그램을 실행할 때마다 컴퓨터가 이해할 수 있는 언어로 한 줄씩 변환하는 방식

<!-- TODO: 컴파일러와 인터프리터의 차이 링크 -->

# JIT(Just-In-Time) 컴파일이란?

JIT 컴파일은<span class="font_highlight">프로그램을 실제 실행하는 시점에 기계어로 변환하는 컴파일 방식</span>입니다. 즉, 프로그램이 실행되는 도중에 필요한 부분만을 컴파일합니다.

이 방식은 컴파일 방식과 인터프리터 방식의 장점을 결합한 것입니다.

그럼 왜 이런 방식을 사용하는 걸까요?

우선, 기존 C/C++의 **컴파일 방식 언어**는 다른 언어들에 비해 빠르다고 많이 들어봤을 것이라고 생각됩니다.

그 이유는 기존 컴파일 언어는 실행 환경에 맞춰 한 번에 정적 네이티브 코드(.exe, 컴퓨터가 바로 실행 가능한 코드)를 생성하기 때문입니다.

반면 **인터프리터 방식**은 소스 코드를 실행 시간에 한 줄씩 읽고, 이를 직접 실행하기 때문에 플랫폼에 독립적인 코드를 작성할 수 있습니다.

따라서, <span class="keyword">**JIT**</span>는 이 두 방식의 장점을 결합한 것으로, 실행 시간을 줄이면서도 코드의 효율성을 증가시키려고 노력한 것이라고 보면 될 것 같습니다.

## 다시, JIT 컴파일이란?

C#이나 JAVA와 같은 JIT 컴파일 언어들은 <span class="important">**컴파일 시**</span> 중간 결과인<span class="keyword">**IL(Intermediate Language)**</span> 코드를 생성하고, 프로그램을 실행 시키면 <span class="important">**런타임**</span>에 가상머신을 이용해서 **동적으로 네이티브 코드를 생성**하게 되는데, 이때의 가상머신에 의한 런타임 컴파일 방식을 JIT 컴파일이라고 합니다. 이것을 두고 **동적 변환(Dynamic translation)**이라고도 합니다.

---

# IL(Intermediate Language) 이란?

IL(Intermediate Language)은 .NET 프레임워크에서 사용하는<span class="important">**중간 언어**</span>입니다.

C#은 컴파일 과정에서 먼저 IL로 변환되며, 이 IL은 **`.NET Framework`**가 설치된 어떠한 환경에서도 실행할 수 있도록 하는, **플랫폼에 독립적인 바이트 코드**입니다.

# CLR (Common Language Runtime) 까지의 동작 과정

IL 코드는 .NET 프레임워크의 **`CLR(Common Language Runtime)`**에서 실행됩니다. CLR은 IL 코드를 JIT 컴파일을 통해 기계어로 변환하고, 이 변환된 코드를 실행합니다. 이 과정에서 CLR은 동적 변환을 수행합니다.

CLR은 .NET Framework의 핵심 구성 요소로, 메모리 관리, 예외 처리, 보안 등의 기능을 제공합니다.

- **메모리 관리**: CLR은 가비지 컬렉션을 통해 메모리를 자동으로 관리합니다. 개발자가 객체를 생성하고 사용하면 CLR이 필요 없어진 객체를 찾아 메모리를 해제합니다.
- **예외 처리**: CLR은 예외 처리 메커니즘을 제공하여, 예외가 발생할 경우 적절한 처리를 할 수 있도록 합니다.
- **보안**: CLR은 코드 액세스 보안(CAS, Code Access Security)을 통해 코드가 수행할 수 있는 작업을 제한합니다. 이를 통해 시스템 리소스를 보호하고, 안전하지 않은 코드로부터 시스템을 보호합니다.

![JIT컴파일 과정.webp](https://i.postimg.cc/mDGY40rb/JIT.png){: w="911" h="451"}

---

# C++ vs C#

C++와 C#의 컴파일 과정은 다릅니다.

<span class="keyword">C++</span>는 전통적인<span class="font_highlight">컴파일 언어</span>로, 소스 코드가 직접 기계어(네이티브 코드)로 변환됩니다. 이 변환 과정은 실행 전에 이루어지며, 결과적으로 생성된 실행 파일은 특정 플랫폼에 종속적입니다.

반면에, <span class="keyword">C#</span>은 IL로 먼저 컴파일되고, 이후<span class="font_highlight">JIT 컴파일</span>을 통해 기계어로 변환됩니다. 이 과정은 컴파일 타임에 한 번, 실행 시점 한 번 이루어지며, 결과적으로 생성된 기계어는 실행 시점의 플랫폼에 맞춰져 있습니다.

JIT 컴파일 방식은 플랫폼에 맞춰 실행할 수 있는 환경 덕분에 개발자가 실행 환경을 고려하지 않고 개발할 수 있지만, 메모리를 많이 사용하고 속도가 떨어지는 단점이 있습니다.

이러한 차이점 때문에, **C++**는 **성능이 중요한 시스템** 수준의 프로그래밍에 주로 사용되며, **C#**은 **플랫폼 독립적인 애플리케이션 개발**에 주로 사용됩니다.